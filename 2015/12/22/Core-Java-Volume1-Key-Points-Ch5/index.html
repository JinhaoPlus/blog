<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="开篇Java是一门不那么简单也不那么复杂的语言，Java里面有很多问题和特性是容易被使用者忽视的，这些问题也许会难住新手，同时也许会是老手不小心跌入的无故之坑，只有精于对基础的提炼才能最大程度地解决类似的疑问。所以，在读Cay.Horstmann的《Java核心技术》的过程中，我记录下这些所谓的易忽略的问题，这些问题将会持续更新在我的这个Segment Fault的博客下，也算是激励自己重新挖掘">
<meta property="og:type" content="article">
<meta property="og:title" content="Core-Java-Volume1-Key-Points-Ch5">
<meta property="og:url" content="http://yoursite.com/2015/12/22/Core-Java-Volume1-Key-Points-Ch5/index.html">
<meta property="og:site_name" content="new JinhaoPlus()">
<meta property="og:description" content="开篇Java是一门不那么简单也不那么复杂的语言，Java里面有很多问题和特性是容易被使用者忽视的，这些问题也许会难住新手，同时也许会是老手不小心跌入的无故之坑，只有精于对基础的提炼才能最大程度地解决类似的疑问。所以，在读Cay.Horstmann的《Java核心技术》的过程中，我记录下这些所谓的易忽略的问题，这些问题将会持续更新在我的这个Segment Fault的博客下，也算是激励自己重新挖掘">
<meta property="og:updated_time" content="2016-10-07T05:07:42.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Core-Java-Volume1-Key-Points-Ch5">
<meta name="twitter:description" content="开篇Java是一门不那么简单也不那么复杂的语言，Java里面有很多问题和特性是容易被使用者忽视的，这些问题也许会难住新手，同时也许会是老手不小心跌入的无故之坑，只有精于对基础的提炼才能最大程度地解决类似的疑问。所以，在读Cay.Horstmann的《Java核心技术》的过程中，我记录下这些所谓的易忽略的问题，这些问题将会持续更新在我的这个Segment Fault的博客下，也算是激励自己重新挖掘">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '我'
    }
  };
</script>




  <link rel="canonical" href="http://yoursite.com/2015/12/22/Core-Java-Volume1-Key-Points-Ch5/"/>

  <title> Core-Java-Volume1-Key-Points-Ch5 | new JinhaoPlus() </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">new JinhaoPlus()</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            我
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Core-Java-Volume1-Key-Points-Ch5
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-22T13:06:58+08:00" content="2015-12-22">
              2015-12-22
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/12/22/Core-Java-Volume1-Key-Points-Ch5/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/12/22/Core-Java-Volume1-Key-Points-Ch5/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>开篇<br>Java是一门不那么简单也不那么复杂的语言，Java里面有很多问题和特性是容易被使用者忽视的，这些问题也许会难住新手，同时也许会是老手不小心跌入的无故之坑，只有精于对基础的提炼才能最大程度地解决类似的疑问。所以，在读Cay.Horstmann的《Java核心技术》的过程中，我记录下这些所谓的易忽略的问题，这些问题将会持续更新在我的这个Segment Fault的博客下，也算是激励自己重新挖掘这些基础问题的内涵。这个博客将以原书中的章节为分割，大概会是每章一篇，持续更新，每篇的内容也不会一次全部写完，视我个人对问题的理解和我的阅读进度而定。</p>
</blockquote>
<p>#Core Java Volume 1 Key Points #</p>
<p>##chap5##</p>
<p>###super关键字和this###<br>super这个关键字和this其实是完全不同的，因为this实际上是一个真实存在的引用，是一个缺省的传入方法的隐式参数，引用当前的对象，所以可以完全当做一个正常的引用来使用。而super并不是父类对象的引用，而只是给javac编译器的一个提示性质的标志。当使用如下的super时：</p>
<ul>
<li><p>super.someFunction();   提示javac在编译这个someFunction()方法的时候去使用该类的父类定义的someFunction()方法，这一般是在当前的子类也定义了同样名字的someFunction()方法的时候去使用的。</p>
</li>
<li><p>super()；或者自定义的super(type Par);  提示javac在编译的时候使用当前子类的父类定义的构造器去初始化当前对象。</p>
</li>
</ul>
<p>所以，总结起来，super的用法归为两种：一是可以调用父类构造器，二是可以调用父类方法。</p>
<p>子类对象的初始化过程：子类执行子类的初始化方法，初始化方法里会先执行缺省的super()方法（写不写这个super方法都会执行），也就是说会先初始化出一个父类对象，然后再执行其他的初始化部分，最终之前初始化出的父类对象将会成为子类对象，这也是多态性的起始，因为本质上来讲，子类对象是有父类对象的结构的。</p>
<p>###继承存在情形下的对象初始化###<br>在继承存在的时候，初始化的过程就变得异常复杂，但是却仍然遵循着初始化的原则：先加载类和属于类的static属性，然后创建类的对象，因为有继承的问题，所以在初始化子类对象的时候要先初始化其父类的对象。<br>这个例子极佳地说明了这个复杂的过程，可以使用单步调试给出初始化的全过程：</p>
<pre><code>class FatherClass {

    private static FatherClass f = new FatherClass();
    static {
        b = 10;
        System.out.println(&quot;father static block&quot;);
    }

    {
        System.out.println(&quot;father object block&quot;);
    }

    static int b = 5;

    public FatherClass() {
        System.out.println(&quot;father constructor...&quot;);
        System.out.println( &quot;b = &quot; + b);

    }
}

public class ChildClass extends FatherClass {
    static int a = 5;
    static {
        a = 10;
        System.out.println(&quot;child static block&quot;);
    }

    {
        System.out.println(&quot;chid object block&quot;);
    }

    private static ChildClass t1 = new ChildClass();

    public ChildClass() {
        System.out.println(&quot;child constructor...&quot;);
        System.out.println(&quot;a = &quot; + a);
    }

    public static void main(String[] args) {
        ChildClass test = new ChildClass();
    }
}
</code></pre><p>这是运行的初始化结果：</p>
<p>先加载类，所以顺序执行static代码块和static属性声明,按照先父类再子类的顺序加载类，</p>
<pre><code>father object block
//加载父类执行f的初始化时激发了父类对象的初始化，对象的初始化块执行
father constructor...   
//对象的构造器
b = 0
//未经初始化的属性的缺省值
father static block
//f的初始化完成，执行父类的静态初始化快，父类加载完毕
child static block
//子类初始化开始，执行子类的静态初始化块
father object block
//t1的初始化激发了子类对象的初始化，并进而激发了父类对象的初始化，执行父类对象初始化块
father constructor...
//执行父类的构造器
b = 5
//父类的域属性已经被初始化，父类对象初始化完成
chid object block
//子类对象开始初始化，对象初始化块执行
child constructor...
//子类对象的构造器执行
a = 10
//子类对象的域属性已被初始化，完成子类的加载
father object block
//执行父类对象的初始化
father constructor...
b = 5
chid object block
//执行子类对象的初始化
child constructor...
a = 10
</code></pre><p>###多态是怎么实现的###<br>如果使用最简单的办法去说明什么是多态，那么这样写无疑是有力的：</p>
<pre><code>FatherClass child = new ChildClass();
child.funcOverride();
</code></pre><p>这个的意思就是说栈中创建的父类对象可以引用堆中的子类对象，那么这个过程为什么可以实现呢？从两个方面可以说明：<br>从对象初始化的角度来说，和上一节我们说到的一样，子类对象的初始化意味父类先加载，子类再加载，父类对象初始化，子类对象初始化，所以子类对象实际上就是在父类对象的基础上生成的，因此父类对象当然可以引用子类对象了；<br>从方法覆盖的角度来说，父类对象的方法子类对象都有，因此对父类方法的使用实际上就会成为对子类方法的使用，这个过程不能反过来，也就是说子类对象的方法并不是父类对象都有，因此不能使用子类对象去引用父类对象。</p>
<p>jvm为了实现多态情况下方法执行的快速判断，会为每个类维护一个虚方法表（和C++实现多态的虚拟函数有关），这个方法表表述了该类型对象在执行某方法时应该执行的方法具体是哪个，理论上在child去执行funcOverride()方法的时候会先去看ChildClass是否拥有覆盖的funcOverride()方法，如果有则执行这个，如果没有覆盖则执行父类的同名方法，而实际上为避免做这些可能要进行多次的判断，jvm为类准备的虚方法表固化这种方法对应关系，进而可以快速定位要执行的方法。</p>
<p>举个例子：</p>
<pre><code>class FatherClass{
    public void func1(){
        System.out.println(&quot;func from FC&quot;);
    }
    public void func2(){
        System.out.println(&quot;func from FC&quot;);
    }
}

class ChildClass extends FatherClass{
    @Override
    public void func1() {
        System.out.println(&quot;func from CC&quot;);
    }
}
</code></pre><p>那么，jvm为类维护的虚方法表类似(不要去考虑和这个问题无关的Object自带方法)：</p>
<pre><code>VirtualMethodTableOfFatherClass:
FatherClass.func1()     --      FatherClass.func1()
FatherClass.func2()     --      FatherClass.func2()

VirtualMethodTableOfChildClass:
ChildClass.func1()     --      ChildClass.func1()
ChildClass.func2()     --      FatherClass.func2()
</code></pre><p>###一个完善的equals方法怎么写呢？###</p>
<p>每个类都源自Object类，所以也就不得不接受Object父类带来的基本方法，比如这个麻烦的额equals方法，在Object类中的equal方法非常简单，就是一句话：</p>
<pre><code>public boolean equals(Object obj) {
    return (this == obj);
}
</code></pre><p>这句话用于判断当前这个栈中变量引用的堆中对象是否和参数变量引用的堆中对象和同一个对象，所以这其实是个很抽象的“相等”，因为这就像废话一样。</p>
<p>所以一个完善的equals方法应该恰当地指出两个对象相等的内涵，即时两个变量并不是指向同一块内存，如果他们的某些被指定的属性是一样的，那么就可以算作是“相等”。所以，我们有以下这样对对象相等的考虑：<br>1.是否指向同一块堆中内存空间，也就是是否引用同一对象，如果是，这肯定相等；<br>2.是否是空引用的比较，如果不是，则才可能相等；<br>3.是否具有同样的类型，如果是，则才可能相等；<br>4.是否具有继承链上的一系列类型，如果是，则可能相等；<br>5.是否某些属性是相等的，如果是，则才可能相等。<br>基于上面的考虑，我们可以有这样的例子来写出一个相对完善的equals方法：<br>（特别注意的是，equals的参数是Object类型的，只有这样才能覆盖Object的equals方法）</p>
<pre><code>class Employee{
    private String name;
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    @Override
    public boolean equals(Object obj) {
        if(this  == obj)
            return true;
        if(obj == null)
            return false;
        if(this.getClass() != obj.getClass())
            return false;
        Employee tempEmployee = (Employee)obj;
        return tempEmployee.getName().equals(name);
    }
}
public class TestClass {
    public static void main(String[] args) {
        Employee employee1 = new Employee();
        employee1.setName(&quot;boss&quot;);
        Employee employee2 = new Employee();
        employee2.setName(&quot;boss&quot;);
        System.out.println(employee1.equals(employee2));
        System.out.println(employee2.equals(employee1));

    }
}
</code></pre><p>###ArrayList之类的集合是值拷贝的和还引是用拷贝的###</p>
<p>我们都知道ArrayList这样的数据集合就是Java快速处理批量数据的容器，那么对这个容器里的每个数据元素而言，是把每个元素的值拷贝到容器中呢还是只是把它们的引用拷贝到容器中去呢？从效率和资源占用的角度来说，ArrayList选择了引用拷贝，只是把“构成”这个集合的数据元素的引用放到了容器中，这个例子说明了这个问题：</p>
<p>并不是每次“添加”一个数据元素到容器中，而是“引用”一个元素到容器中，如果每次都拿一个数据元素做引用，最后所有的容器元素索引都指向一个引用的地址。</p>
<pre><code>class Employee {
    private String name;
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
}
public class TestClass {
    public static void main(String[] args) {
        Employee employee = new Employee();
        ArrayList&lt;Employee&gt; list = new ArrayList&lt;Employee&gt;();
        for (int i = 0; i &lt; 5; i++) {
            employee.setName(&quot;name&quot; + i);
            list.add(employee);
        }
        for (Employee each : list) {
            System.out.println(each.getName());
        }
    }
}
</code></pre><p>未完成。。。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/12/17/Java-Access-Descriptor/" rel="next" title="Java基础 ：细说权限描述符">
                <i class="fa fa-chevron-left"></i> Java基础 ：细说权限描述符
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/02/03/Spring-cxf-integration/" rel="prev" title="Spring-cxf-integration">
                Spring-cxf-integration <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/12/22/Core-Java-Volume1-Key-Points-Ch5/"
           data-title="Core-Java-Volume1-Key-Points-Ch5" data-url="http://yoursite.com/2015/12/22/Core-Java-Volume1-Key-Points-Ch5/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="羅金浩" />
          <p class="site-author-name" itemprop="name">羅金浩</p>
          <p class="site-description motion-element" itemprop="description">金浩的［賅］博客</br>写点我想明白的</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">8</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/JinhaoPlus" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/JinhaoTek/" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://segmentfault.com/u/jinhaoplus" target="_blank" title="SegmentFault">
                  
                    <i class="fa fa-fw fa-laptop"></i>
                  
                  SegmentFault
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <p class="post-toc-empty">此文章未包含目录</p>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">羅金浩</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jinhaoplus"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  

  

  

  

</body>
</html>
